@{
    ViewBag.Title = "Chequeo de Huellas con RENAPER";
}
<style>

  /*  SACAAAR HASTA ACA UNIFICAR*/
    #fondo {
        background-image: none;
        color: black;
    }
</style>
<ol class="breadcrumb">
    <li>@Html.ActionLink("Inicio", "Index", "Home") </li>
    <li><a href="#">Chequeo de Huellas con RENAPER</a></li>

</ol>
<h2>Chequeo de Huellas con RENAPER</h2>

<div class="form-group col-lg-4 tile-light">
    @using (Html.BeginForm("SeleccionHuellasRenaper", "Imputado", FormMethod.Post, new { Id = "formResultadoBusqueda" }))
    {
        @Html.ValidationSummary(true)
        <div>
            @Html.Label("Código de Barra:", new { @class = "control-label" })
            @Html.TextBox("CodigoBarra", "", new { @class = "form-control" })
        </div>
    }

    <div id="cargando" class="form-group col-lg-4" style="display: none;">
        <img src="~/Images/loading.gif" alt="Loading..." />
    </div>
</div>
<br />


    @section Scripts {
        <script type="text/javascript">

            $.widget("custom.iconselectmenu", $.ui.selectmenu, {
                _renderItem: function (ul, item) {
                    var li = $("<li>", { text: item.label });

                    if (item.disabled) {
                        li.addClass("ui-state-disabled");
                    }

                    $("<span>", {
                        style: item.element.attr("data-style"),
                        "class": "ui-icon " + item.element.attr("data-class")
                    })
                      .appendTo(li);

                    return li.appendTo(ul);
                }
            });

            $("#estadoMiembros").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons");



            $("formResultadoBusqueda").submit(function (e) {
                $("#cargando").show();
            });

            function formSubmit() {

                var form = $('#formResultadoBusqueda');
                var criterioSeleccionado = $('#CodigoBarra').val().length > 0;

                $.validator.unobtrusive.parse(form);
                var existingValdiation = form.validate();

                //the settings property corresponds to the options parameter
                existingValdiation.settings.invalidHandler = function (form) {
                    alert('Codigo de barra inválido!');
                };

                if (criterioSeleccionado) {
                    showLoading();
                    form.submit();
                }
            }

            function showLoading() {
                $('#cargando').show();
            }

            $('form input').keydown(function (event) {
                if (event.keyCode == 13) {
                    formSubmit();
                }
            });

            @if (ViewBag.CodigoBarra != null)
    {
        <text>
            $(function () {
                $('#CodigoBarra').val("@ViewBag.CodigoBarra");
                formSubmit();
            });
            </text>
    }
        </script>
    }
